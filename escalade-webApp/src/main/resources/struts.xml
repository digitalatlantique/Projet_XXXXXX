<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC

        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"

        "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>
	<!-- ====Package abstrait contenant la configuration ==== -->
	<package name="base" abstract="true" extends="struts-default">
	
	    <interceptors>
    		<interceptor name="auth" class="org.oc.escalade.webapp.interceptor.AuthentificationInterceptor"/>
    		<interceptor-stack name="authentificationPile">
    			<interceptor-ref name="auth"/>
    			<interceptor-ref name="defaultStack"/>
    		</interceptor-stack>
    	</interceptors>
	    <!-- Results globaux -->
        <global-results>
            <result name="authentificationForm">/jsp/membre/authentification.jsp</result>
        </global-results> 
	
	</package>
	
	<!-- ==== Package public ==== -->
    <package name="public" extends="base">

        <!-- Action par défaut -->
        <default-action-ref name="index" />

        <!-- Action index -->
        <action name="index" class="org.oc.escalade.webapp.action.IndexEscaladeAction" method="doSite">        
            <result name="success">/jsp/index.jsp</result>
        </action>
        
        <!-- Recherche -->
        <action name="recherche" class="org.oc.escalade.webapp.action.RechercheAction" method="doRecherche">
            <interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
        	<result name="input">/jsp/recherche/recherche.jsp</result> 
        	<result name="success" type="redirectAction">
        		<param name="actionName">afficherSite</param>
        	</result>      	
        </action>
        <action name="afficheRechercheMulticritere" class="org.oc.escalade.webapp.action.RechercheMulticritereAction" method="doAfficheRechercheMulticritere">
       	    <interceptor-ref name="store">
		        <param name="operationMode">RETRIEVE</param>			
		    </interceptor-ref>
   			<interceptor-ref name="defaultStack" />
    			
        	<result name="success">/jsp/recherche/rechercheMulticritere.jsp</result>
        </action>
        
        <action name="rechercheMulticritere" class="org.oc.escalade.webapp.action.RechercheMulticritereAction" method="doRechercheMulticritere">
            <interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
		    
		    <result name="input">/jsp/recherche/rechercheMulticritere.jsp</result>
		    
        	<result name="success" type="redirectAction">
        		<param name="actionName">afficherSite</param>
        	</result>
        </action>
        
        <!-- Site -->
        <action name="afficherSite" class="org.oc.escalade.webapp.action.SiteAction" method="doSite">
            <interceptor-ref name="store">
		        <param name="operationMode">RETRIEVE</param>			
		    </interceptor-ref>
   			<interceptor-ref name="defaultStack" />
        	<result name="success">/jsp/escalade/sites.jsp</result>
        </action>
        <action name="siteDetail" class="org.oc.escalade.webapp.action.SiteAction" method="doDetail">
        	<result name="success">/jsp/escalade/siteDetail.jsp</result>
        </action>
        
        <!-- Authentification -->
        <action name="membre" class="org.oc.escalade.webapp.action.MembreAction" method="doAuthentification">
            <interceptor-ref name="store">
		        <param name="operationMode">RETRIEVE</param>			
		    </interceptor-ref>
   			<interceptor-ref name="defaultStack" />
    		<result name="input">/jsp/membre/authentification.jsp</result>
    		<result name="success">/jsp/membre/membre.jsp</result>
    	</action>
    	
    	<!-- Inscription -->
    	<action name="inscription" class="org.oc.escalade.webapp.action.InscriptionAction" method="doInscription">
    	    <interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
    		<result name="input">/jsp/membre/inscription.jsp</result>
    		<result name="success" type="redirectAction">
    			<param name="actionName">membre</param>
    		</result>
    	</action>
    </package>
    
    <!-- ==== Package pour l'espace membre ==== -->
    <package name="prive" extends="base">
   		<!-- Déconnection du membre -->
    	<default-interceptor-ref name="authentificationPile"/>
        <action name="deconnexion" class="org.oc.escalade.webapp.action.MembreAction" method="doDeconnexion">
    		<result name="success">/jsp/membre/authentification.jsp</result>
    	</action>  
    	
    	<!-- Gestion des sites du membre -->
    	<action name="formulaireSite">
    		<result name="success">/jsp/escalade/siteFormulaire.jsp</result>
    	</action>  
    	<action name="creerSite" class="org.oc.escalade.webapp.action.SiteFormulaireAction" method="doNouveauSite">
    	   	<interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
		    <result name="error">/jsp/escalade/siteFormulaire.jsp</result>
    		<result name="success" type="redirectAction">
    			<param name="actionName">mesSites</param>
    		</result>
    	</action>
    	<action name="mesSites" class="org.oc.escalade.webapp.action.SiteAction" method="doMesSites">
            <interceptor-ref name="store">
		        <param name="operationMode">RETRIEVE</param>			
		    </interceptor-ref>
   			<interceptor-ref name="defaultStack" />
    		<result>/jsp/membre/mesSites.jsp</result>
    	</action>
    	<action name="modifierSite" class="org.oc.escalade.webapp.action.SiteFormulaireAction" method="doModifierSite">
      		<result name="input">/jsp/escalade/siteFormulaireModifier.jsp</result> 
    	   	<interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
		    <result name="error">/jsp/escalade/siteFormulaireModifier.jsp</result>
    		<result name="success" type="redirectAction">
    			<param name="actionName">mesSites</param>
    		</result>	
    	</action>
    	<action name="supprimerSite" class="org.oc.escalade.webapp.action.SiteFormulaireAction" method="doSupprimerSite">
    	   	<interceptor-ref name="store">		
		        <param name="operationMode">STORE</param>		
		    </interceptor-ref>		
		    <interceptor-ref name="defaultStack" />
    		<result name="success" type="redirectAction">
    			<param name="actionName">mesSites</param>
    		</result>
    	</action>	

    </package>
</struts>